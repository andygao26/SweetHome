@model FifthGroup_front.ViewModels.CReservations_four

@{
    ViewData["Title"] = "ListR";
}

<div class="col-auto">
    <div class="">

    </div>
</div>

<!-- Page Header Start -->
<div class="container-fluid page-header wow fadeIn">
    <div class="container text-center py-2">
        <h1 class="display-2 text-dark mb-4 animated slideInDown">預約一覽表</h1>
        <nav aria-label="breadcrumb animated slideInDown">
            <ol class="breadcrumb mb-0">
                <li>
                    <a asp-controller="CReservations" asp-action="ReservationsInfor" ><input type="submit" value="新增預約" class="btn btn-primary" /></a>
                </li>
            </ol>
        </nav>
    </div>
</div>
<!-- Page Header End -->
    <div class="container-fluid product py-2">
      <div class="container mb-5">
        <!-- Bootstrap Table with Header - Dark -->
       <div class="card custom-wide-card">
          <div class="table-responsive text-nowrap align-content-center">
                <table class="table">
                    <thead class="table-dark">
                        <tr>
                            <th>姓名</th>
                            <th>場地</th>
                            <th>日期</th>
                            <th>時段</th>
                            <th>審核狀態</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.ReservationPlace)
                        {
                            var ReserveCode = item.ReserveCode;
                            var hName = Model.Reservations.FirstOrDefault(p => p.ReserveCode == ReserveCode)?.HName;

                            var placeCode = item.PlaceCode;
                            var placeName = Model.PublicSpaceDetail.FirstOrDefault(p => p.PlaceCode == placeCode)?.PlaceName;

                            var PeriodoftimeCode = item.PeriodoftimeCode;
                            var Periodoftime = Model.Periodoftime.FirstOrDefault(p => p.PeriodoftimeCode == PeriodoftimeCode)?.Periodoftime1;

@*                             var r = item.ReserveCode;
                            var hstate = Model.Reservations.FirstOrDefault(p => p.ReserveCode == r)?.HState; *@

                           
                            <tr>

                                <td>
                                    @Html.DisplayFor(modelItem => hName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => placeName)
                                </td>
                                <td>
                                    @Convert.ToDateTime(item.FDate).ToString("yyyy/MM/dd")
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => Periodoftime)
                                </td>
                                <td>
                                    <div hidden>    
                                        @Html.DisplayFor(modelItem => item.FState)
                                    </div>
                                    @{
                                        string stateText = "";
                                        string stateClass = "";
                                        switch (item.FState)
                                        {
                                            case 0:
                                                stateText = "未審核";
                                                break;
                                            case 1:
                                                stateText = "申請中";
                                                break;
                                            case 2:
                                                stateText = "已通過";
                                                stateClass = "green-text";
                                                break;
                                            case 3:
                                                stateText = "未通過";
                                                stateClass = "red-text";
                                                break;
                                        }
                                    }
                                    <span class="@stateClass">@stateText</span>
                                </td>
                                <td>
                                    @Html.ActionLink("修改內容", "Edit",new { id=item.ReserveCode }, new { @class = "green-link btn btn-primary" }) |
                                    @Html.ActionLink("取消預約", "Delete","CReservations",new { id=item.ReserveCode },
                                new {@class = "btn btn-danger" ,onclick="return confirm('確定要取消嗎?')"})
                                    @* @Html.ActionLink("詳細資料", "Details", new { /* id=item.PrimaryKey */ }) *@
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
                
          </div>
        </div>
        <!--/ Bootstrap Table with Header Dark -->
      </div>
    </div>
<style>
    .red-text {
        color: red;
    }

    .green-text {
        color: green;
    }
</style>
